<!DOCTYPE html>
<html lang="en" data-bs-theme="dar">
   <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Document</title>
      <link
         href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
         rel="stylesheet"
         integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
         crossorigin="anonymous"
      />
      <script
         src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
         integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
         crossorigin="anonymous"
      ></script>
      <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
      <style>
         #container {
            margin-top: 80px;
         }
         .rtl {
            direction: rtl;
            text-align: right;
         }
         .rtlC {
            direction: ltr;
         }
         .question-box,
         .answer-box {
            padding: 0px 10px 0 0;
         }

         .accordion-button {
            text-align: right;
         }
         .accordion-button::after {
            position: absolute;
            left: 10px;
         }
         p {
            padding: 0px;
            margin: 0px;
         }

         .top-dis {
            background-color: rgba(238, 237, 206, 0.743);
            padding: 8px 0;
            border-radius: 5px;
            overflow: hidden;
            border: 1px solid;
            box-shadow: 0 0 4px inset rgb(191, 191, 191);
            padding-left: 5px;
         }
         .page-link {
            width: 40px;
            text-align: center;
         }
         .back-wh {
            background-color: currentColor;
            border: white;
         }
         .top-dis-nu {
            display: flex;
            gap: 10px;
            align-items: center;
            justify-content: center;
            border: 1px solid white;
            box-shadow: inset 0px 0px 5px white, 0 0 2px black;
            border-radius: 4px;
            /* display: none; */
         }
         .hover-grow:hover {
            transform: scale(1.1);
            transition: transform 0.3s ease;
         }
         .question-input,
         .answer-input {
            width: calc(100% - 27px);
            border: none;
            border-radius: 5px;
            box-shadow: rgb(149, 149, 149) 0 0 2px inset;

            padding: 10px;
            white-space: normal;
            word-wrap: break-word;
            resize: none;
            overflow-y: auto;
            scrollbar-width: none; /* مخفی کردن نوار اسکرول در Firefox */
            -ms-overflow-style: none; /* مخفی کردن در IE و Edge قدیمی */
         }

         .question-input::-webkit-scrollbar,
         .answer-input::-webkit-scrollbar {
            display: none; /* مخفی کردن نوار اسکرول در Chrome, Safari */
         }

         .question-input {
            padding: 10px 10px 10px 0px;
            height: 80px;
            background-color: rgba(177, 207, 213, 0.695);
            font-size: 20px;
            line-height: 2.5;
         }
         #save{
            border: none;
         }
         .question-input:focus,
         .answer-input:focus {
            border: none;
            outline: none;
            box-shadow: inset rgba(55, 95, 196, 0.202) 0 0 10px, inset 0 0 2px rgb(49, 49, 49);
         }

         .question-input::placeholder {
            text-align: right;
            font-size: 20px;
            line-height: 2.5;
         }

         .answer-input {
            height: 50px;
            background-color: rgba(199, 228, 233, 0.809);
         }
         .boten-dis {
            background-color: rgb(210, 233, 245);
            border-radius: 5px;
            overflow: hidden;
            padding: 10px 0px;
         }
         .sign {
            font-size: 25px;
            line-height: 30px;
            position: relative;
            bottom: 2px;
            transition: all 0.5s cubic-bezier(0.2, 0.7, 0.2, 1);
         }

         .move-sign-pos {
            bottom: -93px;
         }
         .move-sign-neg {
            bottom: 95px;
         }
         #pos-neg {
            background-color: #c7e4e9ce;
            /* box-shadow: inset rgba(255, 255, 255, 0.421) 0 7px 8px, inset rgba(255, 255, 255, 0.415) 0 -7px 8px; */
            /* padding: 0px 1px ; */
            border-radius: 5px;
         }
         #pos-neg:active #flash-pos-neg {
            animation: flash 0.5s ease;
         }

         #counterBtn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 60px;
            gap: 3px;
            padding: 4px 10px;
            /* font-size: 18px; */
            font-weight: bold;
            border: none;
            border-radius: 5px;
            background: #b1cfd5b1;
            cursor: pointer;
            overflow: hidden;
            /* box-shadow:  rgba(255, 255, 255, 0.469) 0 4px 3px,  rgba(255, 255, 255, 0.395) 0 -4px 3px; */
         }
         .line {
            width: 80%;
            height: 2px;
            background: black;
            border-radius: 1px;
            transition: background 0.1s ease;
         }
         #counterBtn:active .num {
            color: orange;
            scale: 1.4;
            transition: color 0.1s ease;
         }
         #counterBtn:active .line {
            background-color: orange;
            scale: 1.4;
         }

         .trash2 {
            transform: translateX(-140%);
            opacity: 0;
            pointer-events: none;
         }
         .trash1 {
            transform: translateX(-240%);
            opacity: 0;
            pointer-events: none;
         }
         .general-form {
            border: none;
            border-radius: 5px;
            text-align: center;
            font-size: small;
            padding: 5px 0px;
         }
         #add-answer {
            transition: transform 0.9s ease, opacity 0.4s ease;
         }
         #remove-answer {
            transition: transform 0.6s ease, opacity 0.4s ease;
            z-index: 1;
         }
         #chenge-mode {
            transition: flex-basis 0.5s ease;
         }
         @keyframes flash {
            0% {
               background-image: radial-gradient(ellipse at center, rgb(255, 0, 0) 0%, transparent 70%);
               transform: scale(1);
            }
            50% {
               background-image: radial-gradient(ellipse at center, rgb(255, 30, 0) 0%, transparent 80%);
               transform: scale(1.2);
            }
            100% {
               background-image: radial-gradient(ellipse at center, rgb(255, 0, 0) 0%, transparent 100%);
               transform: scale(1);
            }
         }
         .tols {
            position: relative;
            left: 10px;
         }
         @media (hover: none) {
            .hover-grow:hover {
               transform: none;
            }
         }
         @media screen and (width <= 768px) {
            #design-box {
               position: static !important;
            }
         }
         @media screen and (width >= 768px) {
            #design-box {
               left: calc(40%);
            }
         }

         @media screen and (width >= 992px) {
            #design-box {
               left: calc(38%);
            }
         }
         @media screen and (width >= 1200px) {
            #design-box {
               left: calc(30%);
            }
         }
         @media screen and (width >= 1400px) {
            #design-box {
               left: calc(34%);
            }
         }
      </style>
   </head>
   <body>
      <nav class="navbar bg-body-tertiary fixed-top mb-0">
         <div class="container-fluid">
            <a class="navbar-brand" href="#">Dashboard</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
               <span class="navbar-toggler-icon"></span>
            </button>
            <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
               <div class="offcanvas-header">
                  <h5 class="offcanvas-title" id="offcanvasNavbarLabel">accsess</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
               </div>
               <div class="offcanvas-body">
                  <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                     <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="#">Home</a>
                     </li>
                     <li class="nav-item">
                        <a class="nav-link" href="#">Link</a>
                     </li>
                  </ul>
                  <form class="d-flex mt-3" role="search">
                     <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search" />
                     <button class="btn btn-outline-success" type="submit">Search</button>
                  </form>
               </div>
            </div>
         </div>
      </nav>

      <main class="container" id="container">
         <div class="row">
            <div class="col-sm-12 col-md-5 col-lg-5 col-xl-4 col-xxl-4 left rtl mb-5">
               <div class="accordion accordion-flush" id="accordionFlushExample">
                  <!-- .......................................................oen................................................................ -->
                  <div class="accordion-item">
                     <h2 class="accordion-header">
                        <button
                           class="accordion-button collapsed ps-5 pe-2"
                           type="button"
                           data-bs-toggle="collapse"
                           data-bs-target="#flush-collapseOne"
                           aria-expanded="false"
                           aria-controls="flush-collapseOne"
                        >
                           <p>سوال ؟</p>
                        </button>
                     </h2>
                     <div id="flush-collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
                        <div class="d-flex flex-column mb-0">
                           <div class="p-2 border rounded shadow-sm pe-3">item 1</div>
                           <div class="p-2 border rounded shadow-sm pe-3">item 2</div>
                           <div class="p-2 border rounded shadow-sm pe-3">item 3</div>
                        </div>
                     </div>
                  </div>
                  <!--.......................................................one............................................................-->
                  <div class="accordion-item">
                     <h2 class="accordion-header">
                        <button
                           class="accordion-button collapsed ps-5 pe-2"
                           type="button"
                           data-bs-toggle="collapse"
                           data-bs-target="#flush-collapsetwoo"
                           aria-expanded="false"
                           aria-controls="flush-collapsetwoo"
                        >
                           <p>بزرگترین خزنده در دنیا کیست؟</p>
                        </button>
                     </h2>
                     <div id="flush-collapsetwoo" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
                        <div class="d-flex flex-column mb-0">
                           <div class="p-2 border rounded shadow-sm pe-3">Flex item 1</div>
                           <div class="p-2 border rounded shadow-sm pe-3">Flex item 2</div>
                           <div class="p-2 border rounded shadow-sm pe-3">Flex item 3</div>
                        </div>
                     </div>
                  </div>
                  <!-- ............................................................one............................................................ -->
               </div>
            </div>
            <div id="design-box" class="col-sm-12 col-md-7 col-lg-7 col-xl-8 col-xxl-8 rigth rtl pb-5 position-fixed float-end">
               <div class="container col-sm-12 col-md-10 col-lg-10 col-xl-9 col-xxl-9">
                  <div class="row top-dis mb-2">
                     <div class="col px-0" style="position: relative; right: 6px" height="40px">
                        <img id="ques-plus" src="./petcher/logo-+.png" class="hover-grow" width="70px" alt="" />
                     </div>
                     <div class="col top-dis-nu d-flex justify-content-between gap-2">
                        <div>
                           <button id="save" type="button" class="btn btn-outline-primary fw-medium" style="height: 34px; padding: 0px 5px">
                              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-bookmark-check" viewBox="0 0 16 16">
                                 <path fill-rule="evenodd" d="M10.854 5.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 7.793l2.646-2.647a.5.5 0 0 1 .708 0" />
                                 <path
                                    d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.777.416L8 13.101l-5.223 2.815A.5.5 0 0 1 2 15.5zm2-1a1 1 0 0 0-1 1v12.566l4.723-2.482a.5.5 0 0 1 .554 0L13 14.566V2a1 1 0 0 0-1-1z"
                                 />
                              </svg>
                           </button>
                        </div>
                        <div class="rtlC">
                           <nav aria-label="Page navigation example ">
                              <ul class="pagination mb-0" id="pagination" style="width: 196px"></ul>
                           </nav>
                        </div>
                     </div>
                  </div>
                  <div class="row boten-dis mb-2">
                     <div id="qa-container" class="design col-11 d-flex flex-column justify-content-center p-0">
                        <div class="question-box" style="padding-top: 10px"><textarea placeholder="سوال  طرح شده را وارد کنید" class="question-input" id="question-input"></textarea></div>
                     </div>
                     <div class="design col-1 d-flex flex-column justify-content-evenly align-items-center">
                        <div class="tols">
                           <button id="counterBtn"><span class="num">1</span> <span class="line"></span></button>
                        </div>
                        <div id="pos-neg" class="tols d-flex flex-column align-items-center mt-3">
                           <div id="positive-sign" class="sign">+</div>
                           <img id="flash-pos-neg" src="./petcher/tree2.png" alt="" width="40px" />
                           <div id="negative-sign" class="sign" style="font-size: 35px">-</div>
                        </div>
                     </div>
                  </div>

                  <div class="row rtlC">
                     <div class="col-4 d-flex justify-content-between pe-3 g-0">
                        <button id="clone-ques" class="centralise general-form col-5">Clone<br />Ques</button>
                        <button id="remove-ques" class="centralise general-form col-6">Remove<br />Ques</button>
                     </div>
                     <div class="col-8 d-flex justify-content-between g-0">
                        <button id="chenge-mode" class="centralise general-form col-5">Custom<br />Answer</button>
                        <button id="remove-answer" class="centralise general-form col-3 trash2">Remove<br />Answer</button>
                        <button id="add-answer" class="centralise general-form col-3 trash1">Add<br />Answer</button>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </main>

      <script>
         class QAManager {
            constructor() {
               this.designBox = document.getElementById("design-box");
               this.questions = JSON.parse(localStorage.getItem("qaData")) || [{ question: "", answers: [], rating: 1, isPositive: true, customMode: true }];
               const a = [{ id:1, question: "", options: {}, isNegative: false, isDeleted: false, weight: 1, customeMode: true }];
               this.currentPage = 1;
               this.questionInput = document.getElementById("question-input");
               this.qaContainer = document.getElementById("qa-container");
               this.counterBtn = document.getElementById("counterBtn");
               this.btnNum = this.counterBtn.querySelector(".num");
               this.positiveSign = document.getElementById("positive-sign");
               this.negativeSign = document.getElementById("negative-sign");
               this.modeBtn = document.getElementById("chenge-mode");
               this.addAnswerBtn = document.getElementById("add-answer");
               this.removeAnswerBtn = document.getElementById("remove-answer");
               this.pagination = document.getElementById("pagination");
               this.init();
            }
            formatToSupa(question, options, isNegative, isDeleted, weight, customeMode) {
               const launchData = {
                  question: question,
                  options: options,
                  isNegative: !isNegative,
                  isDeleted: isDeleted ? true : false,
                  weight: weight,
                  customeMode: customeMode,
               };
               console.log(launchData);
               return launchData;
            }
            s(){
               const listId_1= a.map((obj)=> obj.id);
               const listId_2= b.filter(obj => obj.id !== undefined).map(obj => obj.id);
               const listId_remove = listId_1.filter(num => !listId_2.includes(num));
            }
            init() {
               this.api = new MessagesRepository();
               this.bindEvents();
               this.renderPagination();
               this.loadCurrentQuestion();
               this.toggleCustomModeFanction();
               this.renderAccordion();
            }

            async renderAccordion() {
               const accordionContainer = document.querySelector("#accordionFlushExample");
               if (!accordionContainer) return;
               accordionContainer.innerHTML = "";
               try {
                  const quesData = await this.api.fetchAll();
                  console.log(quesData);
                  quesData.forEach((q, index) => {
                     const questionId = `flush-collapse-${index}`;

                     const accordionItem = `
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed ps-5 pe-2"
                                        type="button"
                                        data-bs-toggle="collapse"
                                        data-bs-target="#${questionId}"
                                        aria-expanded="false"
                                        aria-controls="${questionId}">
                                    <p>${q.question || "هیچ سوال ثبت شده ای وجود ندارد !!!"}</p>
                                </button>
                            </h2>
                            <div id="${questionId}" class="accordion-collapse collapse"
                                 data-bs-parent="#accordionFlushExample">
                                <div class="d-flex flex-column mb-0">
                                    ${q.options.map((answer) => `<div class="p-2 border rounded shadow-sm pe-3">${answer.label || "پاسخ..."}</div>`).join("")}
                                </div>
                            </div>
                        </div>`;
                     accordionContainer.insertAdjacentHTML("beforeend", accordionItem);
                  });
               } catch (error) {
                  console.error("خطا در بارگذاری سوالات:", error);
               }
            }

            bindEvents() {
               // نگه داشتن eventهای قدیمی + اضافه کردن جدید
               document.getElementById("counterBtn").addEventListener("click", () => this.updateRating());
               document.getElementById("pos-neg").addEventListener("click", () => this.toggleSign());
               document.getElementById("save").addEventListener("click", () => this.save());
               document.querySelector("#ques-plus").addEventListener("click", () => this.addQuestion());
               document.querySelector("#chenge-mode").addEventListener("click", () => this.toggleCustomMode());
               document.querySelector("#remove-answer").addEventListener("click", () => this.removeLastAnswer());
               document.querySelector("#add-answer").addEventListener("click", () => this.addAnswer());
               document.getElementById("remove-ques").addEventListener("click", () => this.removeQues());
               document.getElementById("clone-ques").addEventListener("click", () => this.cloneQues());

               this.pagination.addEventListener("click", (e) => {
                  if (e.target.classList.contains("page-link")) {
                     this.switchPage(parseInt(e.target.dataset.page));
                  }
               });
            }

            removeQues() {
               if (this.questions.length >= 2) {
                  this.questions.splice(this.currentPage - 1, 1);
               } else {
                  this.questions[0] = {
                     question: "",
                     answers: [],
                     rating: 1,
                     isPositive: true,
                     customMode: true,
                  };
               }
               localStorage.setItem("qaData", JSON.stringify(this.questions));

               if (this.currentPage > 1) {
                  this.currentPage = this.currentPage - 1;
               } else this.currentPage = 1;
               this.renderPagination();
               this.loadCurrentQuestion();

               console.log(JSON.parse(localStorage.getItem("qaData")));
            }

            updateRating() {
               let value = parseInt(this.btnNum.textContent) + 1;
               value = (value % 6) + 1;
               this.btnNum.textContent = value - 1;
               this.questions[this.currentPage - 1].rating = value - 1;
            }

            toggleSign() {
               this.questions[this.currentPage - 1].isPositive = !this.questions[this.currentPage - 1].isPositive;
               this.positiveSign.classList.toggle("move-sign-pos");
               this.negativeSign.classList.toggle("move-sign-neg");
            }

            toggleCustomModeFanction() {
               if (this.questions[this.currentPage - 1].customMode) {
                  this.addAnswerBtn.classList.add("trash1");
                  this.removeAnswerBtn.classList.add("trash2");
                  this.modeBtn.innerHTML = "Costome<br> Answer";
               } else {
                  this.addAnswerBtn.classList.remove("trash1");
                  this.removeAnswerBtn.classList.remove("trash2");
                  this.modeBtn.innerHTML = "Just<br> Ques";
               }
            }
            toggleCustomMode() {
               this.questions[this.currentPage - 1].customMode = !this.questions[this.currentPage - 1].customMode;
               this.toggleCustomModeFanction();
               this.renderAnswers(true);
               this.designBox.scrollIntoView({
                  behavior: "smooth",
               });
            }

            save() {
               this.questions[this.currentPage - 1].question = this.questionInput.value;
               this.questions[this.currentPage - 1].answers = Array.from(this.qaContainer.querySelectorAll(".answer-input")).map((input) => input.value);
               localStorage.setItem("qaData", JSON.stringify(this.questions));
               this.formatToSupa(
                  this.questions[this.currentPage - 1].question,
                  this.questions[this.currentPage - 1].answers,
                  this.questions[this.currentPage - 1].isPositive,
                  false,
                  this.questions[this.currentPage - 1].rating,
                  this.questions[this.currentPage - 1].customMode
               );
            }

            loadCurrentQuestion() {
               const q = this.questions[this.currentPage - 1];
               this.questionInput.value = q.question;
               this.btnNum.textContent = q.rating;

               if (q.isPositive) {
                  this.positiveSign.classList.remove("move-sign-pos");
                  this.negativeSign.classList.remove("move-sign-neg");
               } else {
                  this.positiveSign.classList.add("move-sign-pos");
                  this.negativeSign.classList.add("move-sign-neg");
               }
               this.renderAnswers();
            }
            renderAnswers(click) {
               this.qaContainer.querySelectorAll(".answer-box").forEach((box) => box.remove());

               const q = this.questions[this.currentPage - 1];

               if (!q.customMode) {
                  q.answers.forEach((answer) => {
                     if (answer) this.qaContainer.insertAdjacentHTML("beforeend", `<div class="answer-box"><textarea class="answer-input">${answer}</textarea></div>`);
                  });
                  if (click) {
                     for (let i = q.answers.length; i < 7; i++) {
                        this.qaContainer.insertAdjacentHTML("beforeend", `<div class="answer-box"><textarea class="answer-input" placeholder="جواب سوال را وارد کنید"></textarea></div>`);
                     }
                  }
               }
            }

            addQuestion() {
               this.questions.push({
                  question: "",
                  answers: [],
                  rating: 1,
                  isPositive: true,
                  customMode: true,
               });
               this.currentPage = this.questions.length;
               this.renderPagination();
               this.loadCurrentQuestion();
            }

            switchPage(page) {
               this.currentPage = page;
               this.renderPagination();
               this.loadCurrentQuestion();
            }

            renderPagination() {
               this.pagination.innerHTML = "";
               const total = this.questions.length;
               const visibleQues = 5;

               let startQues = Math.max(1, this.currentPage - Math.floor(visibleQues / 2));
               let endQues = startQues + visibleQues - 1;

               if (endQues > total) {
                  endQues = total;
                  startQues = Math.max(1, endQues - visibleQues + 1);
               }

               for (let i = startQues; i <= endQues; i++) {
                  const li = document.createElement("li");
                  li.className = `page-item ${i === this.currentPage ? "active" : ""}`;
                  const a = document.createElement("a");
                  a.className = "page-link";
                  // a.href = "#";
                  a.dataset.page = i;
                  a.textContent = i;
                  li.appendChild(a);
                  this.pagination.appendChild(li);
               }
               this.toggleCustomModeFanction();
            }

            removeLastAnswer() {
               const lastAnswer = this.qaContainer.querySelector(".answer-box:last-child");
               if (lastAnswer && this.qaContainer.children.length > 3) {
                  lastAnswer.remove();
               }
            }

            addAnswer() {
               if (this.qaContainer.children.length < 8) {
                  this.qaContainer.insertAdjacentHTML("beforeend", `<div class="answer-box"><textarea class="answer-input" placeholder="جواب سوال را وارد کنید"></textarea></div>`);
                  this.designBox.scrollIntoView({
                     behavior: "smooth",
                  });
               }
            }
         }

         class MessagesRepository {
            constructor() {
               const SUPABASE_URL = "https://ympwqgpxrppeibbuqmbg.supabase.co";
               const SUPABASE_ANON_KEY = "sb_publishable_oC4F33OTk5u8kgE3i9s_nQ_3erwT-Vj";
               this.supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
               this.table = "questions";
            }

            // ۱) خواندن: فقط دیتا را برمی‌گرداند
            async fetchAll() {
               const { data, error } = await this.supabase.from(this.table).select("*").order("created_at", { ascending: false });

               if (error) throw error;
               return data; // فقط آرایه رکوردها
            }

            // ۲) اضافه‌کردن: یک یا چند ردیف
            async insertMany(rows) {
               // rows: آرایه‌ی آبجکت‌ها [{ text: '...', question: '...' }, ...]
               const { data, error } = await this.supabase.from(this.table).insert(rows).select();

               if (error) throw error;
               return data; // ردیف‌های تازه ایجادشده
            }

            // ۳) ویرایش: یک یا چند ردیف همزمان
            async updateMany(updates) {
               /**
                * updates = [
                *   { id: 1, text: 'متن جدید ۱' },
                *   { id: 5, text: 'متن جدید ۵', question: 'سوال جدید' }
                * ]
                * شرط اصلی این است که هر آبجکت یک id یا کلید یکتا داشته باشد.
                */
               const { data, error } = await this.supabase
                  .from(this.table)
                  .upsert(updates, { onConflict: "id" }) // اگر id وجود داشت → update
                  .select();

               if (error) throw error;
               return data;
            }
         }
         const qaManager = new QAManager();
      </script>
   </body>
</html>
